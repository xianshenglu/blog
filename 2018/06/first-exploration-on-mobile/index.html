<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="mobile,layout,rem,viewport,layout viewport,visual viewport,css pixel,device pixel,DPR,retina,meta,device-width,initial-scale,user-scalable,">










<meta name="description" content="PrefaceRecently, I have been working on mobile development. Before this I have heard something strange but I didn’t pay attention to. Now, I have to figure out though there is a lot of stuff. I am try">
<meta name="keywords" content="mobile,layout,rem,viewport,layout viewport,visual viewport,css pixel,device pixel,DPR,retina,meta,device-width,initial-scale,user-scalable">
<meta property="og:type" content="article">
<meta property="og:title" content="First Exploration on Mobile">
<meta property="og:url" content="https://github.com/xianshenglu/blog/2018/06/first-exploration-on-mobile/index.html">
<meta property="og:site_name" content="Hey , you !">
<meta property="og:description" content="PrefaceRecently, I have been working on mobile development. Before this I have heard something strange but I didn’t pay attention to. Now, I have to figure out though there is a lot of stuff. I am try">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://github.com/blog/images/%E6%88%AA%E5%9B%BE20180614143059.png">
<meta property="og:image" content="https://github.com/blog/images/%E6%88%AA%E5%9B%BE20180614143060.gif">
<meta property="og:image" content="https://github.com/blog/images/%E6%88%AA%E5%9B%BE20180615093229.png">
<meta property="og:image" content="https://github.com/blog/images/%E6%88%AA%E5%9B%BE20180615090536.png">
<meta property="og:image" content="https://github.com/blog/images/%E6%88%AA%E5%9B%BE20180615090453.png">
<meta property="og:image" content="https://github.com/blog/images/%E6%88%AA%E5%9B%BE20180615155759.png">
<meta property="og:image" content="https://github.com/images/%E6%88%AA%E5%9B%BE20180615090453.png">
<meta property="og:updated_time" content="2023-08-21T16:32:21.010Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="First Exploration on Mobile">
<meta name="twitter:description" content="PrefaceRecently, I have been working on mobile development. Before this I have heard something strange but I didn’t pay attention to. Now, I have to figure out though there is a lot of stuff. I am try">
<meta name="twitter:image" content="https://github.com/blog/images/%E6%88%AA%E5%9B%BE20180614143059.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://github.com/xianshenglu/blog/2018/06/first-exploration-on-mobile/">





  <title>First Exploration on Mobile | Hey , you !</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hey , you !</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/xianshenglu/blog/blog/2018/06/first-exploration-on-mobile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xianshenglu">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hey , you !">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">First Exploration on Mobile</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-06-14T14:11:45+00:00">
                2018-06-14
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/blog/categories/css/" itemprop="url" rel="index">
                    <span itemprop="name">css</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="Preface"><a href="#Preface" class="headerlink" title="Preface"></a>Preface</h2><p>Recently, I have been working on mobile development. Before this I have heard something strange but I didn’t pay attention to. Now, I have to figure out though there is a lot of stuff. I am trying to make it clear as possible as I can but I am not sure content below is completely right.</p>
<h2 id="Basic-concepts"><a href="#Basic-concepts" class="headerlink" title="Basic concepts"></a>Basic concepts</h2><h3 id="Css-Pixels-Physical-Pixels-and-DPR"><a href="#Css-Pixels-Physical-Pixels-and-DPR" class="headerlink" title="Css Pixels, Physical Pixels and DPR"></a>Css Pixels, Physical Pixels and DPR</h3><p>First, let’s start with demo:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"cont"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span>left<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right"</span>&gt;</span>right<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cont</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: pink;</span><br><span class="line">  <span class="attribute">overflow</span>: auto;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20%</span>;</span><br><span class="line">  <span class="attribute">background</span>: lightblue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">float</span>: right;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20%</span>;</span><br><span class="line">  <span class="attribute">background</span>: yellowgreen;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Before switching to device mode, make sure you don’t have code starts with <code>&lt;meta name=&quot;viewport&quot; ...</code> in your <code>head</code> tag.</p>
<p>Normally, we will find everything seems ok when we switch to mobile. For example, Let’s switch to iPhone6.</p>
<p><img src="/blog/images/%E6%88%AA%E5%9B%BE20180614143059.png"></p>
<p>According to <a href="https://developer.chrome.com/devtools/docs/device-mode" target="_blank" rel="noopener">chrome-devtools</a>, width 375 and height 667 is <code>css pixels</code>. And before we keep going , we need to figure out some terms first including <code>css pixels</code>, <code>physical pixels</code> and <code>DPR</code>. Here is some related readings:</p>
<ul>
<li><p><a href="https://stackoverflow.com/questions/3588983/converting-between-physical-pixels-and-css-pixels" target="_blank" rel="noopener">converting-between-physical-pixels-and-css-pixels</a></p>
</li>
<li><p><a href="https://stackoverflow.com/questions/8785643/what-exactly-is-device-pixel-ratio" target="_blank" rel="noopener">what-exactly-is-device-pixel-ratio</a></p>
</li>
<li><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio" target="_blank" rel="noopener">mdn-devicePixelRatio</a></p>
</li>
</ul>
<p>After reading those stuff, I am still confused. But I can figure something out at least. Well, here is the point based on iPhone6:</p>
<ul>
<li><p>width 375 and height 667 is <code>css pixels</code></p>
</li>
<li><p><code>DPR</code> is 2</p>
</li>
<li><p><code>DPR</code> &#x3D; <code>physical pixels</code>&#x2F;<code>css pixels</code>. So <code>physical pixels</code> is 750*1334</p>
</li>
</ul>
<h3 id="Layout-Viewport-and-Visual-Viewport"><a href="#Layout-Viewport-and-Visual-Viewport" class="headerlink" title="Layout Viewport and Visual Viewport"></a>Layout Viewport and Visual Viewport</h3><p>Ok, let’s keep going. If you calculate the dimensions of viewport, you will get some strange values like below:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.documentElement.clientWidth <span class="comment">//980</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight <span class="comment">//1743</span></span><br></pre></td></tr></table></figure>

<p>Maybe you thought that the value should be 375*667 or 750*1334. However, it doesn’t. The result 980*1743 is the dimensions of <code>layout viewport</code>. Well, before keep going we need to know something about <code>layout viewport</code> and <code>visual viewport</code>. Here is the related articles:</p>
<ul>
<li><p><a href="https://www.quirksmode.org/mobile/viewports.html" target="_blank" rel="noopener">quirksmode-viewports</a></p>
</li>
<li><p><a href="https://www.quirksmode.org/mobile/viewports2.html" target="_blank" rel="noopener">quirksmode-viewports2</a></p>
</li>
<li><p><a href="https://quirksmode.org/mobile/viewports/" target="_blank" rel="noopener">quirksmode-viewports-app</a></p>
</li>
</ul>
<p>Based on the articles above we can be sure of something about <code>layout viewport</code> and <code>visual viewport</code>.</p>
<ul>
<li><p><code>layout viewport</code> is the area that the browser uses to calculate the dimensions of elements with percentual width.</p>
</li>
<li><p><code>visual viewport</code> is the part of the page that’s currently shown on-screen. The user may scroll to change the part of the page he sees, or zoom to change the size of the <code>visual viewport</code>.</p>
</li>
<li><p>Zoom doesn’t change the size of <code>layout viewport</code> but <code>visual viewport</code>.</p>
</li>
<li><p>The size of <code>visual viewport</code> &lt;&#x3D; the size of <code>layout viewport</code>.</p>
</li>
<li><p>Both <code>layout viewport</code> and <code>visual viewport</code> are measured by <code>css pixels</code>.</p>
</li>
<li><p>Many mobile browsers initially show any page in fully zoomed-out mode to show the complete content of the site. Thus <code>layout viewport</code> is equal to the <code>visual viewport</code> at that moment.</p>
</li>
</ul>
<p>And in this case of iPhone6, here is something we can be sure of:</p>
<ul>
<li><p><code>layout viewport</code> is 980*1743</p>
</li>
<li><p><code>visual viewport</code> is also 980*1743</p>
</li>
<li><p>The mobile browser show the page in fully zoomed-out mode to show the complete content of the site.</p>
</li>
</ul>
<h3 id="Meta-Tag"><a href="#Meta-Tag" class="headerlink" title="Meta Tag"></a>Meta Tag</h3><p>Now, we know what happened when we switch to mobile mode. Also, we know why the size of font becomes smaller in visual.</p>
<p>However, we would want the <code>layout viewport</code> to be 375*667 or 750*1334 if we want to build a adaptive website. Fortunately, we can control the size of <code>layout viewport</code> by tag <code>meta</code>. For instance,</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=375,initial-scale=1,user-scalable=no"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>You can find the doc of <code>meta</code> in <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta#Specifications" target="_blank" rel="noopener">mdn-meta</a> and <code>viewport</code> in <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Mobile/Viewport_meta_tag" target="_blank" rel="noopener">mdn-viewport_meta_tag</a>. In the code above, we define 375px for the <code>width</code> of <code>layout viewport</code>. Here, 375px is <code>css pixels</code>. Also, you can prove it by:</p>
<figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">document</span>.documentElement.clientWidth <span class="comment">//375</span></span><br><span class="line"><span class="built_in">document</span>.documentElement.clientHeight <span class="comment">//667</span></span><br></pre></td></tr></table></figure>

<p>So, any change? Yes. The change is the font-size is bigger in visual than before. Before we change the text is too small to read.</p>
<p>We can keep testing by change the <code>width</code> in <code>meta</code>. For example, let’s try 750:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=750,initial-scale=1,user-scalable=no"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Look what we got:</p>
<p><img src="/blog/images/%E6%88%AA%E5%9B%BE20180614143060.gif"></p>
<p>This makes sense. However, if you remove <code>user-scalable=no</code> in the <code>meta</code> the browser will again enter into the fully zoomed-out mode. In that case, you will find the font-size is smaller and the whole page is showed in the screen which make the effect of <code>initial-scale=1</code> disappear.</p>
<p>To be compatible with mobiles with different sizes we need to switch the number to <code>device-width</code>:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width,initial-scale=1,user-scalable=no"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>It is easy to understand, I think. Until now, it seems that we can be compatible with mobiles. Is that true?</p>
<h2 id="Adaptive-Layout"><a href="#Adaptive-Layout" class="headerlink" title="Adaptive Layout"></a>Adaptive Layout</h2><p>In the case above, we set <code>width:50%</code> for the <code>.left</code> and <code>.right</code> box. So, they could be adaptive. If we use <code>px</code> the page will not be adaptive because the size of viewport varies between mobiles. So, we have two choices</p>
<ol>
<li>Use different size according to the size of viewport</li>
<li>Use percentage always</li>
</ol>
<p>Option2 will work if our page is simple enough. In most instances, it will bring a disaster because of nested elements. One modification in parent will bring changes to all descendant elements.</p>
<p>The problem of option1 is if we can avoid writing so many media queries codes to adapt to different sizes of viewport. For example:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* ... other codes for .cont with different sizes */</span></span><br><span class="line">@<span class="keyword">media</span> (max-width: <span class="number">800px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.cont</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@<span class="keyword">media</span> (max-width: <span class="number">400px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.cont</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*... other codes for .cont with different sizes */</span></span><br></pre></td></tr></table></figure>

<p>Actually, we can avoid these codes. The key is <code>rem</code>. For example, code above can be simplified like:</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">html</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">80px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cont</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2.5rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* no more codes for .cont with different sizes */</span></span><br></pre></td></tr></table></figure>

<p>When the size of viewport is 400px, we just need to update the <code>font-size</code> of <code>html</code> with <code>40px</code>. That is easy with js. Seems wonderful with <code>rem</code>? huh?</p>
<p>You can use <code>rem</code> everywhere and js just run one time. Here is the related lib <a href="https://github.com/amfe/lib-flexible">lib-flexible</a>.</p>
<h2 id="Latest-Adaptive-Layout"><a href="#Latest-Adaptive-Layout" class="headerlink" title="Latest Adaptive Layout"></a>Latest Adaptive Layout</h2><p>Basically, there is no big problem with <code>rem</code>. Well, you might realize that we can totally use <code>vw</code> instead. That’s correct! The compatibility has become better for most developers to use. The same thing happen to <code>flex</code> and <code>grid</code> layout. Until 2018.6, <code>flex</code> is a choice but we still need to wait for <code>grid</code> or look for some polyfill.</p>
<p>However, there is still some little problems when using <code>vw</code> or <code>rem</code> layout.</p>
<ul>
<li>We still use <code>px</code> for <code>font-size</code> and <code>border</code>.</li>
</ul>
<p>I think it is easy to understand because decimals would appear. In that case, we may get <code>15px</code> or <code>17px</code> instead of <code>16px</code>. At the same time, <code>border</code> may disappear because of some numbers like <code>0.9px</code>.</p>
<ul>
<li>Develop with plugins</li>
</ul>
<p>For instance, if we are developing based on iPhone6 whose width is 375px in css pixel while the designer gives us a PSD whose width is 750px, how we are going to do? Calculate the div with 75px and transform to 10% and write 10vw? So we calculate and write it one by one? That’s terrible.</p>
<p>We can just write 75px and other numbers and leave the transform jobs to plugins(e.g. <code>less</code>,<code>postcss</code>.etc.).</p>
<h2 id="Problems-Caused-by-DPR"><a href="#Problems-Caused-by-DPR" class="headerlink" title="Problems Caused by DPR"></a>Problems Caused by DPR</h2><h3 id="Blurry-or-Sharp-in-Different-DPR-Device"><a href="#Blurry-or-Sharp-in-Different-DPR-Device" class="headerlink" title="Blurry or Sharp in Different DPR Device"></a>Blurry or Sharp in Different DPR Device</h3><p>Until now, we haven’t talked about DPR which we mentioned in the beginning. As <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio" target="_blank" rel="noopener">mdn-devicepixelratio</a> says:</p>
<blockquote>
<p>In simpler terms, this tells the browser how many of the screen’s actual pixels should be used to draw a single CSS pixel.</p>
</blockquote>
<p>On the desktop or before the appearance of Retina display, DPR is always equal to 1. However, things became complicated after that. At present, there is a lot of DPR on the market which varies from 1 to 4. Sometimes, there comes 1.5 or 2.75. Anyway, we will talk about it later.</p>
<p>We can always get DPR by <code>window.devicePixelRatio</code>. The problem is that on retina screens or device whose DPR more than 1 images will become blurry. Of course we will try to avoid that. So, we have to figure out what happened to those mobiles with bigger DPR.</p>
<p>According to <a href="https://www.smashingmagazine.com/2012/08/towards-retina-web/" target="_blank" rel="noopener">towards-retina-web</a>,</p>
<blockquote>
<p>A bitmap pixel is the smallest unit of data in a raster image (PNG, JPG, GIF, etc). Each pixel contains information on how it is to be displayed, including its position in the image’s coordinate system and its color.</p>
</blockquote>
<blockquote>
<p>Beside its raster resolution, an image on the Web has an abstract size, defined in CSS pixels. The browser squeezes or stretches the image based on its CSS height or width during the rendering process.</p>
</blockquote>
<blockquote>
<p>When a raster image is displayed at full size on a standard-density display, 1 bitmap pixel corresponds to 1 device pixel, resulting in a full-fidelity representation. Because a bitmap pixel can’t be further divided, it gets multiplied by four on Retina displays(assuming DPR is 2) to preserve the same physical size of the image, losing detail along the way.</p>
</blockquote>
<p>For example, we got iPhone6 whose DPR is 2. And img we have is:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"example.png"</span> <span class="attr">width</span>=<span class="string">"2"</span> <span class="attr">height</span>=<span class="string">"2"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Assume that size of example.png is 2*2 and the picture is like:</p>
<p><img src="/blog/images/%E6%88%AA%E5%9B%BE20180615093229.png"></p>
<p>With DPR of 2, the browser has to use 2 device pixels to draw a single css pixel. So <code>img</code> with 2*2 css pixels will be drew by 4*4 device pixel which means example.png with 2*2 bitmap pixels will be drew by 4*4 device pixel. So, 4 bitmap pixels of example.png will be drew by 16 device pixels which means 1 bitmap pixel will be drew by 4 device pixels.</p>
<p>Let’s move on, normally what we want might be:</p>
<p><img src="/blog/images/%E6%88%AA%E5%9B%BE20180615090536.png"></p>
<p>However, actual result will be:</p>
<p><img src="/blog/images/%E6%88%AA%E5%9B%BE20180615090453.png"></p>
<p>The result happens because 1 bitmap pixel can’t be further divided into 4 device pixels. That’s what @smashingmagazine says:</p>
<blockquote>
<p>A bitmap pixel is the smallest unit of data in a raster image (PNG, JPG, GIF, etc).</p>
</blockquote>
<blockquote>
<p>Because a bitmap pixel can’t be further divided, it gets multiplied by four on Retina displays(assuming DPR is 2) to preserve the same physical size of the image, losing detail along the way.</p>
</blockquote>
<p>You can also find another example in <a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio" target="_blank" rel="noopener">mdn-devicepixelratio</a>.</p>
<p>So, how can we fix this? Basically, choices we have are listed as below:</p>
<ol>
<li>Change the size of <code>img</code>, for example:</li>
</ol>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"example.png"</span> <span class="attr">width</span>=<span class="string">"1"</span> <span class="attr">height</span>=<span class="string">"1"</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>In this case, <code>img</code> with 1*1 css pixel will be drew by 2*2 device pixels which means example.png with 2*2 bitmap pixels will be divided by 2*2 device pixels. Hence, 1 bitmap pixel corresponds to 1 device pixel.</p>
<p>We might not use this alone because the layout would be affected.</p>
<ol start="2">
<li>Replace example.png with 4*4 and keep the original <code>img</code> with 2*2 css pixels, same explanation as above.</li>
</ol>
<p>In this case, we might do this by changing the <code>src</code> attribute in the <code>img</code>. For example, update the <code>src</code> search param <code>?v=2*2</code> with <code>?v=4*4</code> or change from example.png to <a href="mailto:&#x65;&#120;&#x61;&#109;&#x70;&#x6c;&#x65;&#64;&#50;&#120;&#x2e;&#x70;&#110;&#x67;" target="_blank" rel="noopener">&#x65;&#120;&#x61;&#109;&#x70;&#x6c;&#x65;&#64;&#50;&#120;&#x2e;&#x70;&#110;&#x67;</a>. <a href="https://github.com/strues/retinajs">retinajs</a> will help you do this job.</p>
<ol start="3">
<li><p>Use icon-font instead of raster image.</p>
</li>
<li><p>Use svg instead.</p>
</li>
</ol>
<p>Actually, what you need to care about is not only <code>img</code> but also <code>background-image</code>. So, option1 and option2 will be not convenient without any other help(e.g. retinajs).</p>
<p>Also, with DPR smaller than 2 we need to switch size back. If not, image will become sharp which is the opposite process of blur. For instance:</p>
<p><img src="/blog/images/%E6%88%AA%E5%9B%BE20180615155759.png"></p>
<p>Compare with the process of blur:</p>
<p><img src="/blog/../images/%E6%88%AA%E5%9B%BE20180615090453.png"></p>
<p>Option3 and option4 would be easier. And with the help of <a href="http://www.iconfont.cn/" target="_blank" rel="noopener">iconfont</a>, things can be easier and easier when you choose svg.</p>
<p>Personally, I would choose option4 in daily work. For more information about the options, click <a href="https://www.smashingmagazine.com/2012/08/towards-retina-web/" target="_blank" rel="noopener">towards-retina-web</a>.</p>
<h3 id="Problems-about-Border"><a href="#Problems-about-Border" class="headerlink" title="Problems about Border"></a>Problems about Border</h3><p>Assume that we are using iPhone6 whose DPR is 2, border with 1 css pixel will be drew with 2 device pixels. Does that matter?</p>
<p>Yeah, sometimes that make the border thicker in visual. When we set 1px on border, actually what we might want is to set the thinnest border that device support. Normally, on desktop browser 1px is the thinnest. So in this case, you might need to talk with designer if he wants the thinnest border(e.g. 0.5px) or still 1px.</p>
<p>Anyway, there is lots of ways if we want to set the thinnest border. So, I wrote another blog to talk about that. Please check <a href="./layout-on-mobile.md">border on mobile</a>.</p>
<h2 id="Ending"><a href="#Ending" class="headerlink" title="Ending"></a>Ending</h2><p>I have written too much about the basic knowledge about layout on mobile. However, there are still lots of problems I haven’t mentioned. Anyway, I will write them in other blogs.</p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://www.quirksmode.org/mobile/viewports.html" target="_blank" rel="noopener">quirksmode-viewports</a></p>
<p><a href="https://www.quirksmode.org/mobile/viewports2.html" target="_blank" rel="noopener">quirksmode-viewports2</a></p>
<p><a href="https://quirksmode.org/mobile/viewports/" target="_blank" rel="noopener">quirksmode-viewports-app</a></p>
<p><a href="https://www.quirksmode.org/blog/archives/2010/04/a_pixel_is_not.html" target="_blank" rel="noopener">a_pixel_is_not</a></p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta#Specifications" target="_blank" rel="noopener">mdn-meta</a></p>
<p><a href="https://developer.mozilla.org/en-US/docs/Mozilla/Mobile/Viewport_meta_tag" target="_blank" rel="noopener">mdn-viewport_meta_tag</a></p>
<p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Window/devicePixelRatio" target="_blank" rel="noopener">mdn-devicepixelratio</a></p>
<p><a href="https://drafts.csswg.org/mediaqueries-3/#units" target="_blank" rel="noopener">specs-mediaqueries-3</a></p>
<p><a href="https://developer.chrome.com/devtools/docs/device-mode" target="_blank" rel="noopener">chrome-devtools</a></p>
<p><a href="https://stackoverflow.com/questions/8785643/what-exactly-is-device-pixel-ratio" target="_blank" rel="noopener">what-exactly-is-device-pixel-ratio</a></p>
<p><a href="https://stackoverflow.com/questions/3588983/converting-between-physical-pixels-and-css-pixels" target="_blank" rel="noopener">converting-between-physical-pixels-and-css-pixels</a></p>
<p><a href="https://www.smashingmagazine.com/2012/08/towards-retina-web/" target="_blank" rel="noopener">towards-retina-web</a></p>
<p><a href="http://www.iconfont.cn/" target="_blank" rel="noopener">iconfont</a></p>
<p><a href="https://github.com/strues/retinajs">retinajs</a></p>
<p><a href="https://github.com/amfe/lib-flexible">lib-flexible</a></p>
<p>Chinese:</p>
<p><a href="https://segmentfault.com/a/1190000004336869" target="_blank" rel="noopener">移动端适配方案(上)</a></p>
<p><a href="https://segmentfault.com/a/1190000004358316" target="_blank" rel="noopener">移动端适配方案(下)</a></p>
<p><a href="http://www.html-js.com/article/Mobile-terminal-H5-mobile-terminal-HD-multi-screen-adaptation-scheme%203041" target="_blank" rel="noopener">移动端高清、多屏适配方案</a></p>
<p><a href="https://www.w3cplus.com/mobile/lib-flexible-for-html5-layout.html" target="_blank" rel="noopener">使用 flexible 实现手淘 h5 页面的终端适配</a></p>
<p><a href="https://www.w3cplus.com/mobile/vw-layout-in-vue.html" target="_blank" rel="noopener">如何在 vue 项目中使用 vw 实现移动端适配</a></p>
<p><a href="https://www.w3cplus.com/css/vw-for-layout.html" target="_blank" rel="noopener">再聊移动端页面的适配</a></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/mobile/" rel="tag"># mobile</a>
          
            <a href="/blog/tags/layout/" rel="tag"># layout</a>
          
            <a href="/blog/tags/rem/" rel="tag"># rem</a>
          
            <a href="/blog/tags/viewport/" rel="tag"># viewport</a>
          
            <a href="/blog/tags/layout-viewport/" rel="tag"># layout viewport</a>
          
            <a href="/blog/tags/visual-viewport/" rel="tag"># visual viewport</a>
          
            <a href="/blog/tags/css-pixel/" rel="tag"># css pixel</a>
          
            <a href="/blog/tags/device-pixel/" rel="tag"># device pixel</a>
          
            <a href="/blog/tags/dpr/" rel="tag"># DPR</a>
          
            <a href="/blog/tags/retina/" rel="tag"># retina</a>
          
            <a href="/blog/tags/meta/" rel="tag"># meta</a>
          
            <a href="/blog/tags/device-width/" rel="tag"># device-width</a>
          
            <a href="/blog/tags/initial-scale/" rel="tag"># initial-scale</a>
          
            <a href="/blog/tags/user-scalable/" rel="tag"># user-scalable</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2018/06/label-can-t-be-focused-in-firefox-with-element.focus()/" rel="next" title="Label Can't Be Focused In Firefox With Element.focus()">
                <i class="fa fa-chevron-left"></i> Label Can't Be Focused In Firefox With Element.focus()
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2018/06/layout-on-mobile/" rel="prev" title="Layout On Mobile">
                Layout On Mobile <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">xianshenglu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">51</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/blog/categories/index.html">
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/blog/tags/index.html">
                  <span class="site-state-item-count">141</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Preface"><span class="nav-number">1.</span> <span class="nav-text">Preface</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Basic-concepts"><span class="nav-number">2.</span> <span class="nav-text">Basic concepts</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Css-Pixels-Physical-Pixels-and-DPR"><span class="nav-number">2.1.</span> <span class="nav-text">Css Pixels, Physical Pixels and DPR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Layout-Viewport-and-Visual-Viewport"><span class="nav-number">2.2.</span> <span class="nav-text">Layout Viewport and Visual Viewport</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Meta-Tag"><span class="nav-number">2.3.</span> <span class="nav-text">Meta Tag</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Adaptive-Layout"><span class="nav-number">3.</span> <span class="nav-text">Adaptive Layout</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Latest-Adaptive-Layout"><span class="nav-number">4.</span> <span class="nav-text">Latest Adaptive Layout</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Problems-Caused-by-DPR"><span class="nav-number">5.</span> <span class="nav-text">Problems Caused by DPR</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Blurry-or-Sharp-in-Different-DPR-Device"><span class="nav-number">5.1.</span> <span class="nav-text">Blurry or Sharp in Different DPR Device</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Problems-about-Border"><span class="nav-number">5.2.</span> <span class="nav-text">Problems about Border</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Ending"><span class="nav-number">6.</span> <span class="nav-text">Ending</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reference"><span class="nav-number">7.</span> <span class="nav-text">Reference</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xianshenglu</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
